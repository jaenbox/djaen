# app/config/security.yml
security:
    encoders:
        AppBundle\Entity\Persona:
          algorithm:  bcrypt
          cost: 12

    role_hierarchy:
        ROLE_TEC: ROLE_USER
        ROLE_HELP: ROLE_USER
        ROLE_SUPER_ADMIN: [ ROLE_ADMIN, ROLE_USER ]

    providers:
        db_provider:
          entity:
            class: AppBundle:Persona

    firewalls:
        dev:
            pattern: ^/(_(profiler|wdt)|css|images|js)/
            security: false
        main:
            pattern: ^/
            provider: db_provider
            form_login:
              login_path: /login
              check_path: /login_check
              default_target_path: 'index'
              always_use_default_target_path: true
              use_referer: true
              failure_path: 'index'
            logout:
              path: /logout
              target: 'index'
            security: true
            anonymous: true

    access_control:
        - { path: ^/[a-z]+/login, roles: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/[a-z]+/index, role: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/[a-z]+/admin/new, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/admin/edit, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/admin/delete, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/admin/show, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/user, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/cliente/new, role: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/[a-z]+/cliente/edit, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/cliente/delete, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/cliente/show, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/helpdesk/new, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/helpdesk/edit, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/helpdesk/delete, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/helpdesk/show, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/tecnico/new, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/editTecnico, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/deleteTecnico, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/tecnico/show, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/incidencia, role: [ ROLE_SUPER_ADMIN, ROLE_TEC, ROLE_USER, ROLE_HELP ] }
        - { path: ^/[a-z]+/incidencia/new, role: [ ROLE_SUPER_ADMIN, ROLE_TEC, ROLE_HELP, ROLE_USER ] }
        - { path: ^/[a-z]+/incidencia/edit, role: [ ROLE_SUPER_ADMIN, ROLE_HELP, ROLE_TEC ] }
        - { path: ^/[a-z]+/incidencia/delete, role: [ ROLE_SUPER_ADMIN, ROLE_HELP, ROLE_TEC ] }
        - { path: ^/[a-z]+/incidencia/list, role: [ ROLE_SUPER_ADMIN, ROLE_TEC, ROLE_HELP ] }
        - { path: ^/[a-z]+/incidencia/show, role: [ ROLE_SUPER_ADMIN, ROLE_TEC, ROLE_HELP, ROLE_USER ] }
        - { path: ^/[a-z]+/estado/new, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/estado/edit, role: ROLE_SUPER_ADMIN }
        - { path: ^/[a-z]+/estado/delete, role: ROLE_SUPER_ADMIN }